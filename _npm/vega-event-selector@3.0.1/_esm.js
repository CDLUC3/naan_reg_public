/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/vega-event-selector@3.0.1/build/vega-event-selector.module.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const t="[",e="]",r="{",n="}",i=":",s=",",o="@",l=">",c=/[[\]{}]/,u={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let h,f;function a(t,e,r){return h=e||"view",f=r||u,p(t.trim()).map(w)}function m(t,e,r,n,i){const s=t.length;let o,l=0;for(;e<s;++e){if(o=t[e],!l&&o===r)return e;i&&i.indexOf(o)>=0?--l:n&&n.indexOf(o)>=0&&++l}return e}function p(i){const o=[],l=i.length;let c=0,u=0;for(;u<l;)u=m(i,u,s,t+r,e+n),o.push(i.substring(c,u).trim()),c=++u;if(0===o.length)throw"Empty event selector: "+i;return o}function w(u){return"["===u[0]?function(r){const n=r.length;let i,s=1;if(s=m(r,s,e,t,e),s===n)throw"Empty between selector: "+r;if(i=p(r.substring(1,s)),2!==i.length)throw"Between selector must have two elements: "+r;if(r=r.slice(s+1).trim(),r[0]!==l)throw"Expected '>' after between selector: "+r;i=i.map(w);const o=w(r.slice(1).trim());if(o.between)return{between:i,stream:o};o.between=i;return o}(u):function(l){const u={source:h},a=[];let p,w,g=[0,0],b=0,d=0,y=l.length,x=0;if(l[y-1]===n){if(x=l.lastIndexOf(r),!(x>=0))throw"Unmatched right brace: "+l;try{g=function(t){const e=t.split(s);if(!t.length||e.length>2)throw t;return e.map((e=>{const r=+e;if(r!=r)throw t;return r}))}(l.substring(x+1,y-1))}catch(t){throw"Invalid throttle specification: "+l}y=(l=l.slice(0,x).trim()).length,x=0}if(!y)throw l;l[0]===o&&(b=++x);p=m(l,x,i),p<y&&(a.push(l.substring(d,p).trim()),d=x=++p);if(x=m(l,x,t),x===y)a.push(l.substring(d,y).trim());else if(a.push(l.substring(d,x).trim()),w=[],d=++x,d===y)throw"Unmatched left bracket: "+l;for(;x<y;){if(x=m(l,x,e),x===y)throw"Unmatched left bracket: "+l;if(w.push(l.substring(d,x).trim()),x<y-1&&l[++x]!==t)throw"Expected left bracket: "+l;d=++x}if(!(y=a.length)||c.test(a[y-1]))throw"Invalid event selector: "+l;y>1?(u.type=a[1],b?u.markname=a[0].slice(1):(v=a[0],f[v]?u.marktype=a[0]:u.source=a[0])):u.type=a[0];var v;"!"===u.type.slice(-1)&&(u.consume=!0,u.type=u.type.slice(0,-1));null!=w&&(u.filter=w);g[0]&&(u.throttle=g[0]);g[1]&&(u.debounce=g[1]);return u}(u)}export{a as parseSelector};export default null;
